---
title: 'Práctica programada 2'
author: "Susana Meoño Piedra"
date: "2023-08-04"
output: html_document
---

a. Cree un archivo Rmarkdown para resolver esta práctica programada. En el chunk de setup cargue las librerías que considere necesarias para resolver la práctica. Los datos para trabajar puede cargarlos con la función read_csv de readr directamente de la siguiente dirección: “https://raw.githubusercontent.com/isa229/programacion_analisis_datos_ii/main/air_quality_index.csv”. (1pto)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(datasets)
library(datos)
library(readr) #lectura y carga de datos
library(readxl)
library(tidyr)# doma de datos
library(janitor) #limpieza de datos
library(lubridate)
library(hms)
library(stringr)
library(gt)
library(tinytex)
library(writexl) # para guardar datos como excel
library(utils)
library(RSQLite) # para interactuar con bases de datos sqlite
library(DBI) # ayuda con conexiones a bbdd
library(leaflet)
library(ggplot2)
library(plotly)
library(utils)
```

Carga de los datos:

```{r}
datos_air_quality <- read_csv("https://raw.githubusercontent.com/isa229/programacion_analisis_datos_ii/main/air_quality_index.csv") 
clean_names(datos_air_quality)
View(datos_air_quality)
```

Este conjunto de datos contiene información acerca del índice de calidad del aire (AQI) de distintas ciudades alrededor del mundo. Las coordenadas geográficas de estas se encuentran como lat (latitud) y lng (longitud).


b. Cuántas categorías diferentes de AQI (AQI Category) hay en este conjunto de datos? Cuáles son? (2pts)

```{r}
conteo_categorias <- datos_air_quality |>
  distinct(`AQI Category`)|>
  select(`AQI Category`)
View(conteo_categorias)

#En total hay 6 categorías distintas de AQI: Moderate, Good, Unhealthy, Very Unhealthy, Unhealthy for Sensitive Groups y Hazardous.
```


c. Cree una tabla que indique la cantidad de ciudades que hay en cada categoría de AQI (AQI Category).
Adicionalmente, traduzca las categorías a español, por ejemplo “Good” sería “Bueno”. Presente esta tabla con el paquete gt, añadiendo títulos y subtítulos (10pts).

```{r} 
#Primero creo la tabla solicitada
ciudades_AQI <- datos_air_quality |>
  group_by(`AQI Category`)|>
  summarise(cantidad_ciudades = NROW(City))
View(ciudades_AQI)
```

```{r}
#Luego traduzco las categorías
ciudades_AQI <- data.frame(Categoría_AQI = c("Bueno", "Peligroso", "Moderado", "Insalubre", "Insalubre para grupos sensibles", "Muy insalubre"), 
                           Cantidad_Ciudades = c(7708,62,7054,871,869,131))
```

```{r}
#Ajusto el nombre de las columnas
colnames(ciudades_AQI) <- c("CATEGORÍA AQI", "CANTIDAD DE CIUDADES")
```

```{r}
#Convierto la tabla a un objeto gt
ciudades_AQI_gt <- ciudades_AQI |>
  gt() 
ciudades_AQI_gt
```

```{r}
#Agrego títulos y subtítulos
ciudades_AQI_gt <- ciudades_AQI |>
 gt() |> 
   tab_header(
  title = "Cantidad de ciudades según Categoría del Índice de Calidad del Aire (AQI)" ,
  subtitle = "Datos de la calidad del aire mundial"
  )
ciudades_AQI_gt
```



